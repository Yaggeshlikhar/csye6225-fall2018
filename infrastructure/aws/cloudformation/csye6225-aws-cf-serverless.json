{  
    "AWSTemplateFormatVersion":"2010-09-09",
    "Description":"AWS CloudFormation Lambda",
    "Parameters":{  
       "HandlerName":{  
          "Description":"Lambda handler",
          "Type":"String",
          "Default":"handler"
       },
       "ModuleName":{  
          "Description":"JavaScript file",
          "Type":"String",
          "Default":"customresource"
       },
       "LambdaRole":{  
        "Description":"lambdaServiceRole for lambda",
        "Type":"String"
        },
      
       "S3Key":{  
          "Description":"TZip file",
          "Type":"String"
       }
    },



    "Resources":{  
       "LambdaFunction":{  
          "Type":"AWS::Lambda::Function",
          "Properties":{  
             "Code":{  
                "S3Bucket":{"Fn::ImportValue" : "S3BucketForLambda"},
                "S3Key":{  
                    "Ref":"S3Key"
                }
             },
             
              "Handler":"index.handler",
             "Role":{"Ref":"LambdaRole"},
             "Runtime":"java8",
             "Timeout":"30",
             "TracingConfig":{  
                "Mode":"Active"
             }
          }
       
    },
     "MySNSTopic" : {
        "Type" : "AWS::SNS::Topic",
        "Properties" : {
            "TopicName" : "SampleTopic",
                "Subscription" : [
                    {"Endpoint": {
                    "Fn::GetAtt": [
                        "LambdaFunction",
                        "Arn"
                    ]
                },
                "Protocol":"lambda"
            }
           ]
        }
     },
    
       "LambdaInvokePermission": {
        "Type": "AWS::Lambda::Permission",
        "Properties": {
            "FunctionName": {
                "Fn::GetAtt": [
                    "LambdaFunction",
                    "Arn"
                ]
            },
            "Action": "lambda:InvokeFunction",
            "Principal": "sns.amazonaws.com",
            "SourceArn": {"Ref":"MySNSTopic"}
            }
        }
    }
    
 }

